
<!DOCTYPE html>
<html>
  <head>
    
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112753095-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-112753095-1');
      </script>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="/style/semantic.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/style/main.css" type="text/css" media="all" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" integrity="sha256-N1K43s+8twRa+tzzoF3V8EgssdDiZ6kd9r8Rfgg8kZU=" crossorigin="anonymous" />
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.7.1/dist/katex.min.css">
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.7.1/dist/katex.min.js"></script>
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.7.1/dist/contrib/auto-render.min.js"></script>
      <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body);
        });
      </script>
    
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"></script>
    <script src="/style/semantic.min.js" charset="utf-8"></script>
    <script>
      function setIframeHeight(id) {
        var ifrm = document.getElementById(id);
        var doc = ifrm.contentDocument? ifrm.contentDocument:
            ifrm.contentWindow.document;
        ifrm.style.visibility = 'hidden';
        ifrm.style.height = "10px"; // reset to minimal height ...
        // IE opt. for bing/msn needs a bit added or scrollbar appears
        ifrm.style.height = window.getDocHeight( doc ) + 4 + "px";
        ifrm.style.visibility = 'visible';
      }


      function getDocHeight(doc) {
        doc = doc || document;
        // stackoverflow.com/questions/1145850/
        var body = doc.body, html = doc.documentElement;
        var height = Math.max( body.scrollHeight, body.offsetHeight,
            html.clientHeight, html.scrollHeight, html.offsetHeight );
        return height;
      }
    </script>
    <title>The great FFT (Part 1)</title>
  </head>
  <body class="Site">
    <div class="ui fixed navbar menu Site-header">
      <div class="ui container">
        <div class="ui left secondary menu">
          <a href="/" class="item">
            Siddharth
          </a>
        </div>
        <div class="ui right secondary menu">
          <a href="/blog" class="item">
            <i class="pencil icon"></i> Blog
          </a>
          <a href="/archive" class="item">
            <i class="archive icon"></i> Archive
          </a>
        </div>
      </div>
    </div>
    <div class="ui Site-content container">
      
<div>
  <h1 class="ui header">
    The great FFT (Part 1)
  </h1>
  <div class="ui divider"></div>
  <div>
    <p>If you are in the field of software, you've probably wondered at some point: <code>What are the coolest algorithms ever discovered?</code>. As a fun task, I decided to try and understand <a href="http://www.uta.edu/faculty/rcli/TopTen/topten.pdf">SIAM's top 10 algorithms of the 20th century</a>.</p>
<p><a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">The Fast Fourier Transform (FFT)</a> algorithm is revolutionary. The applications of FFT touches nearly every area of engineering in some way. The <a href="http://www.ams.org/journals/mcom/1965-19-090/S0025-5718-1965-0178586-1/S0025-5718-1965-0178586-1.pdf">Cooley-Tukey</a> paper rediscovered (<a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform#History">It was found in Gauss's notes for calculations in astronomy! ðŸ¤·</a>) and popularized FFT. It is one of the most widely cited papers in science and engineering!</p>
<p>FFT is something I've used a lot, but didn't quite understand fully. I always thought of it as something that makes the <a href="https://en.wikipedia.org/wiki/Fourier_transform">Fourier transform</a> faster, in order to view time domain signals in their frequency domain. In reality, that is just one application of FFT. For me, the key view point was: <strong>FFT is all about making basic polynomial operations fast!</strong>.</p>
<h2>Polynomials</h2>
<p>A <a href="https://en.wikipedia.org/wiki/Polynomial">Polynomial</a> is an expression of the form \[A(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + ... a_{n-1}ax^{n-1}\]<br>
where \(a_i\) are Real numbered coefficients(typically) and x is some variable. A(x) is defined to have a <strong>degree of n-1</strong> (Yup, one less than the number of terms!)</p>
<h2>Representation of Polynomials</h2>
<p>How can polynomials be represented in a computer?</p>
<p><strong>Coefficient Representation</strong><br>
\[(a_0, a_1, a_2 ... a_{n-1})\] Simple enough, its a vector or list of numbers! This representation is often very useful, as it can represent any kind of one-dimensional data. Sure, if we care about \(x\), we can write a function A(x) to take some variable x and do something with x and these coefficents. If not, we just keep it as a vector.</p>
<p><strong>Point-Value Representation</strong> \[[(x_0, y_0), (x_1, y_1), (x_2, y_2), ... (x_{n-1}, y_{n-1})]\] Since a polynomial A(x) can be thought of as a function from \(x\) to \(y\), another way to represent a polynomial would be by pairs of (input, output) values. Wow! Are you saying we need to define A(x) at all possible values of x? Nope, it turns out there is a fundamental property of polynomials that states that:</p>
<p><em>Given n pairs \((x_0,y_0),...,(x_{n-1},y_{n-1})\), with all the \(x_i\)'s distinct, there is a unique polynomial<br>
p(x) of degree (at most) n such that \(p(x_i) = y_i\) for \(0 \le i \le (n-1).\)</em></p>
<p>In other words, a polynomial of degree \((n-1)\) is uniquely specified by giving \(n\) point-value pairs. Intuitively, that makes sense. How many points do we need to represent a line (which can be represented as a polynomial of the form \(y = ax + b\))? 2 points! What continuous curve can we draw through 3 points? parabola! A proof can be found <a href="https://web.stanford.edu/~dntse/classes/cs70_fall09/n6.pdf">here</a></p>
<h2>What can we do with a Polynomial?</h2>
<h3>Evaluation</h3>
<p>Given a polynomial \(p\) and a number x, compute p(x).</p>
<h3>Addition</h3>
<p>Given two polynomials \(p(x)\) and \(q(x)\), find a polynomial \(r = p + q\), such that \(r(x) = p(x) + q(x)\) for all \(x\). If \(p\) and \(q\) both have degree \(n\), then the sum also has degree \(n\).</p>
<h3>Multiplication</h3>
<p>Given two polynomials \(p(x)\) and \(q(x)\), find a polynomial \(r = pq\), such that \(r(x) = p(x).q(x)\) for all \(x\). If \(p\) and \(q\) both have degree \(n\), then the product has degree \(2n\).</p>
<h3>Complexity of these operations</h3>
<p>Assuming the polynomials are represented using the <strong>coefficient representation</strong>:</p>
<p><strong>Evaluation</strong>: A simple for-loop can achieve this in <em>O(n)</em> arithmetic operations. (We can cut down the multiplications further using <a href="https://en.wikipedia.org/wiki/Horner%27s_method">horner's scheme</a>)<br>
<strong>Addition</strong>: A simple for-loop can achieve this in <em>O(n)</em> arithmetic operations.<br>
<strong>Multiplication</strong>: Ha! this is more complicated and takes <em>O(\(n^2\))</em> arithmetic operations. (Sure, we can reduce the asymptotic runtime by using some <a href="https://en.wikipedia.org/wiki/Sch%C3%B6nhage%E2%80%93Strassen_algorithm">fancy</a> tricks, but the constants are still pretty large.)</p>
<p><em>What if we change the representation to point-value?</em></p>
<p><strong>Addition</strong>: Simple! Given 2 polynomials, \((x_1, y_1), (x_2, y_2), . . . (x_{n-1}, y_{n-1})\) and \((x_1, z_1), (x_2, z_2), . . . (x_{n-1}, z_{n-1})\)  we simply add the output values and get \((x_i, y_i + z_i)\). Thus, it requires <em>\(O(n)\)</em> arithmetic operations.</p>
<p><strong>Note (detail):</strong> <em>Both polynomials need to be defined for the same n points, else we'll have to do a little more work using <a href="https://en.wikipedia.org/wiki/Lagrange_polynomial">Lagrange interpolation</a>.</em></p>
<p><strong>Multiplication</strong>: Simple! Given, 2 polynomials \((x_1, y_1), (x_2, y_2), . . . (x_{n-1}, y_{n-1})\) and \((x_1, z_1), (x_2, z_2), . . . (x_{n-1}, z_{n-1})\)  we simply multiply the output values and get \((x_i, y_i * z_i)\). Thus, it requires <em>\(O(n)\)</em> arithmetic operations.</p>
<p><strong>Note (detail):</strong> <em>when we multiply 2 polynomials, we are going to get a polynomial of higher degree, so we'll need more points to represent it. For example, multiplying 2 \((n-1)\) degree polynomials will result in a polynomial of degree (2n - 1). This can be handled by taking more samples of the 2 input polynomials before multiplication</em></p>
<h3>Summary</h3>
<p>So this is where we are:</p>
<table>
<thead>
<tr>
<th>Representation</th>
<th>Multiply</th>
<th>Evaluate</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr>
<td>Coefficient</td>
<td>\(O(n^2)\)</td>
<td>\(O(n)\)</td>
<td>\(O(n)\)</td>
</tr>
<tr>
<td>Point-Value</td>
<td>\(O(n)\)</td>
<td>\(O(n^2)\)</td>
<td>\(O(n)\)</td>
</tr>
</tbody>
</table>
<p><em>Can we somehow convert between the representations efficiently so that we get the best of both? This is where the FFT comes in!</em></p>
<h2>Converting between representations</h2>
<p>For a polynomial \(A(x) = a_0 + a_1x + ... a_{n-1}x^{n-1}\) of degree \((n-1)\), the conversion from coefficient representation to point-value representation at n distinct points \((x_0, x_1, ... x_n)\) can be done as follows:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mn>0</mn><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mn>1</mn><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>a</mi><mn>0</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>a</mi><mn>1</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>a</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
    y_0 \\
    y_1 \\
    .\\
    .\\
    .\\
    y_{n-1} \\
\end{bmatrix} =
\begin{bmatrix}
    1 &amp; x_0 &amp; x_0^2 &amp; ... &amp; x_0^{n-1} \\
    1 &amp; x_1 &amp; x_1^2 &amp; ... &amp; x_1^{n-1} \\
    .\\
    .\\
    .\\
    1 &amp; x_{n-1} &amp; x_{n-1}^2 &amp; ... &amp; x_{n-1}^{n-1} \\
\end{bmatrix}
\begin{bmatrix}
    a_0 \\
    a_1 \\
    .\\
    .\\
    .\\
    a_{n-1} \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:4.486162em;"></span><span class="strut bottom" style="height:8.472324em;vertical-align:-3.986162em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-3.6100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-2.4100000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-1.2100000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:-0.010000000000000397em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:1.1899999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:2.39em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:3.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-3.6220540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">1</span></span></span><span style="top:-2.3979459999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">1</span></span></span><span style="top:-1.1979460000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:0.0020540000000000558em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:1.2020540000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:2.4261620000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">1</span></span></span><span style="top:3.6261620000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.6220540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-2.3979459999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:2.426162000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.6220540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-2.3979459999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:2.426162000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.6220540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span><span style="top:-2.3979459999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span><span style="top:2.426162000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.6220540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.256439em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-2.3979459999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.256439em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:2.426162000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.256439em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-3.6100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-2.4100000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:-1.2100000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:-0.010000000000000397em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:1.1899999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">.</span></span></span><span style="top:2.39em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span style="top:3.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.3050399999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:2.1500399999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:1.5490399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.9480399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:0.3470399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.2539600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-0.8549600000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-1.4559600000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-2.05696em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-3.3029800000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></span></span></p>
<p>where \[\vec{a}\] is a vector of coefficients and \[\vec{y}\] is a vector of output values. This is known as the <a href="https://en.wikipedia.org/wiki/Vandermonde_matrix">Vandermonde matrix</a>. It's a nice way of vectorizing the conversion and make the runtime \(O(n^2) operations\). Thus, if we need the \(y_i\) values for point-value representation, we simply do</p>
<p>\[ \vec{y} = V\vec{a}\]</p>
<p>To convert from point-value to coefficient representation, we take the inverse of \(V^{-1}\).</p>
<p>\[ V^{-1}\vec{y} = \vec{a}\]</p>
<p><strong>Fact:</strong> <em>\(V\) is inverttible if \(x_i\)'s are distinct.</em></p>
<p>Anyways, the point is, the forward and reverse conversion takes \(O(n^2)\) operations.</p>
<h3>Can we do better?</h3>
<p>If you look at the above matrix-vector product hard enough, you'll notice that <strong>we get to pick the x values in \(V\)</strong>. i.e <em>The sample positions!</em> If we pick these sample values with the 'right structure', maybe this conversion can be faster. Sure, it is not very generic, but we don't care! We still get to convert between <em>point-value</em> \(\leftrightarrow\) <em>coefficient representation</em> of the given polynomial.</p>
<p><em>FFT exploits this freedom</em></p>
<h2>Divide and Conquer!</h2>
<h3>What is our goal?</h3>
<p>Before we lose the forest for the trees, this is what we want:</p>
<ul>
<li>We have a polynomial A(x) in its coefficient form \(&lt;a_0, a_1, . . . a_{n-1}&gt;\) and a input set X.</li>
<li>We need to compute \(&lt;y_0, y_1, . . . y_{n-1}\) from \(A(x) \forall x \in X\).</li>
<li>The reason we want to do this, is so that we can quickly switch from coefficient to polynomial representation. (And vice-versa, but we'll leave that for now)</li>
<li>The key insight from the previous section was that we are <em>free</em> to choose the input set X.</li>
</ul>
<p>Ok, now back to <strong>divide and conquer</strong>.</p>
<p>The essence of any <a href="https://people.eecs.berkeley.edu/~vazirani/algorithms/chap2.pdf">divide and conquer algorithm strategy</a> is as follows:</p>
<ol>
<li>Divide problem into <em>smaller</em> subproblems.</li>
<li>Recursively solve (conquer) the subproblems.</li>
<li>Combine solutions to the subproblem into one for the original problem.</li>
</ol>
<p>The above link gives some basic examples in this paradigm.</p>
<h3>Divide and Conquer idea for Polynomials</h3>
<p>Consider the polynomial \(A(x) = a_0 + a_1x + a_2x^2 + . . . a_{7}x^{7}\).</p>
<ul>
<li><strong>Divide</strong><br>
Express \(A(x)\) as a sum of its <em>odd</em> and <em>even</em> powers.</li>
</ul>
<p>\[ A_{even}(x) = a_0 + a_2x + a_4x^2 + a_6x^3 \]<br>
\[ A_{odd}(x) = a_1 + a_3x + a_5x^2 + a_7x^3 \]</p>
<ul>
<li>
<p><strong>Conquer</strong><br>
Recursively compute \(A_{even}(z)\) and \(A_{odd}(z)\) \(\forall z \in { x^2 | x \in X }\)</p>
</li>
<li>
<p><strong>Combine</strong><br>
Combine them with \(O(1)\) arithmetic operations (Specifically, 1 multiplication and 1 addition) to get \(A(x)\)!</p>
</li>
</ul>
<p>\[ A(x) = A_{even}(x^2) + xA_{odd}(x^2) \]</p>
<p><em>Note that we evaluate both \(A_{even}\) and \(A_{odd}\) at \(x^2\) for the numbers to work out. That's key.</em></p>
<p><em>Note: <strong>Basecase:</strong> We stop recursing, when our polynomial just has  1 coefficient</em></p>
<p><strong>Do we have smaller a subproblems?</strong></p>
<p>i.e, is \(A_{even}(z)\) and \(A_{odd}(z)\) \(\forall z \in { x^2 | x \in X }\) smaller than \(A(x) \forall x \in X\)?</p>
<p>If we look at the the set of input values on which \(A_{even}\) and \(A_{odd}\) are evaluated, we still need them to be defined for all values of \(x^2\).</p>
<p>For the divide and conquer technique to work, we need the subproblems to be of a smaller size.</p>
<p><em>Can we find a set of \(n\) points such that the set formed by squaring each value, is a smaller set?</em></p>
<p>Ex) If my set \(X = {x^2}\), with one element. What can my set 'x' be, so that it is bigger?</p>
<p>Yup, it can be \(X = {x, -x}\). Ha, squareroots can do the trick! Ok, this works if we only need 2 sample values in our set X, what if we need 3?</p>
<p>Hmm, that seems complex ;)</p>
<h2>Enter Complex Numbers!</h2>
<p>Restating our problem here, just so we don't get lost:</p>
<ul>
<li>In order to represent our polynomial of degree \((n-1)\), we need to find a set \(X\) of 'n'.</li>
<li>From the previous section, we see that we can write a polynomial in terms of its <em>odd</em> and <em>even</em> coefficients evaluated at \(x^2\).</li>
<li>For our divide and conquer to work effectively, we need new set \(Z = {x^2 | x \in X}\) to be smaller than X.</li>
</ul>
<p><em>So, how do we arrive at a set of n points such that everytime we square it, we get a smaller set.</em> (I am using the term square loosely here, I mean the set we get by squaring each element in our current set)</p>
<p><strong>It turns out we can <em>always</em> come up with a set of n points, such that they <em>collapse</em> into a set of <em>n/2</em> points when squared, using complex numbers</strong> (Yes, <em>n</em> has to be even)</p>
<p>If you don't quite have an intuitive idea of what complex numbers are, I highly recommend <a href="https://betterexplained.com/articles/a-visual-intuitive-guide-to-imaginary-numbers/">this post on betterexplained</a> by Kalid.<br>
For me, the big takeaway about complex numbers was to think about them as <em>rotations</em>. Do read that post.</p>
<p><img src="https://betterexplained.com/wp-content/uploads/complex/positive_negative_rotation.png" alt="Complex number rotation" title="Complex numbers are just rotations"></p>
<p>Let's start with a set \(S_1 = { 1 }\). What set can collapse into this set?</p>
<p>Easy, \(S_2 = {-1, 1}\). What set collapses to \(S_2\)?</p>
<p>Easy, \(S_3 = {i, -i, 1, -1}\). What set collapses to \(S_3\)?</p>
<p>Not so easy (until you read Kalid's post!), but it's \(S_4 = {\frac{\sqrt{2}}{2}(1 + i), -\frac{\sqrt{2}}{2}(i + i), \frac{\sqrt{2}}{2}(i - 1), -\frac{\sqrt{2}}{2}(i + 1), i, -i, 1, -1}\).</p>
<p>We can keep going. In essence, <em>we can always find a set that collapses like this, for any even n, however big!</em> Take a minute, that is like wow!</p>
<p>Formally, a set containing \(n\) points that collapse as shown above, are called the <em>nth roots of unity</em>. If we square these \(n\) points, n times, we get 1 (The basecase of our recursion)!</p>
<h2>Running time of our Divide and Conquer Algorithm</h2>
<p>Ok, let's just step back and see how well our divide and conquer algorithm would perform.</p>
<ul>
<li>We take our polynomial \(A(x)\), to be evaluated on a set \(X\) with \(|X| = n\), and reduce it to two smaller problems.</li>
<li>\(A_{even}(x)\) and \(A_{odd}(x)\), both evaluated on set \(Y = {x^2 | x \in X}\) with \(|Y| = n/2\).</li>
</ul>
<p>We can write a recurrence relation for the above algorithm as:</p>
<p>\[T(n) = 2T(\frac{n}{2}) + O(n)\]</p>
<p>where \(T(n)\) is the running time of our algorithm on an input of size \(n\). <a href="https://users.cs.duke.edu/~reif/courses/alglectures/skiena.lectures/lecture3.pdf">Solving this</a>, we get a <strong>runtime bound of O(n lgn)</strong></p>
<p>Cool! We can now <em>Add</em>, <em>Evaluate</em> and <em>Multiply</em> polynomials in \(O(n lg n)\) time!</p>
<p><strong>This elegant divide and conquer algorithm, is the FFT algorithm!</strong></p>
<p>I hope this helps you understand what the FFT is all about.<br>
In the next post, we will discuss how its implemented, where the \(e^{i\theta}\) and <em>fourier</em> related terms come in.</p>
<h3>References</h3>
<ul>
<li><a href="http://jeffe.cs.illinois.edu/teaching/algorithms/notes/02-fft.pdf">Jeff Erickson Algorithm notes</a></li>
<li><a href="http://faculty.cs.tamu.edu/klappi/csce629-f17/csce411-set4c.pdf">TAMU Klappenecker Algorithms</a>.</li>
<li><a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-design-and-analysis-of-algorithms-spring-2015/lecture-videos/lecture-3-divide-conquer-fft/">OCW Erik Demaine FFT</a></li>
</ul>

  </div>
</div>


    </div>
    <footer class="ui Site-footer center aligned segment">
      <h2 class="ui header">
        <a href="https://twitter.com/_subsid"  class="item" target="_blank"><i class="icon twitter square"></i></a>
        <a href="https://www.linkedin.com/in/subsid"  class="item" target="_blank"><i class="linkedin icon"></i></a>
        <a href="https://www.github.com/subsid"  class="item" target="_blank"><i class="github icon"></i></a>
      </h2>
      <p style=>
        <a href="/blog" class="item">Blog</a>
        &nbsp;&#183;&nbsp;
        <a href="/archive" class="item">Archive</a>
        &nbsp;&#183;&nbsp;
        <a href="/feed.xml" class="item">RSS</a></p>
    </footer>
  </body>
</html>

